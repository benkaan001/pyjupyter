# INTERMEDIATE QUESTIONS

## 1. Write a query to retrieve the top 10 customers who spent the most money at the store.

- ### Hint: You will need to join the `customers` and `invoices` tables and use an aggregate function to calculate the total amount spent by each customer.

## Expected Output

   | CustomerName        | TotalSpent|
   |---------------------|-----------|
   | Helena Holý         | 49.62     |
   | Richard Cunningham  | 47.62     |
   | Luis Rojas          | 46.62     |
   | François Tremblay   | 45.62     |
   | Edward Francis      | 42.62     |
   | Jack Smith          | 42.62     |
   | Michelle Brooks     | 39.62     |
   | Tim Goyer           | 39.62     |
   | Robert Brown        | 39.62     |
   | Jennifer Peterson   | 38.62     |


## 2.Write a query to retrieve top 5 customers who live in the USA and have spent the most in year 2013.

- ### Hint: You will need to join the `customers` and `invoices` tables and use WHERE clauses to filter for customers who live in the USA.

## Expected Output

   | FirstName | LastName    | Country | TotalSpent |
   |-----------|-------------|---------|------------|
   | Richard   | Cunningham | USA     | 48.0       |
   | Julia     | Barnett     | USA     | 44.0       |
   | Frank     | Ralston     | USA     | 44.0       |
   | Victor    | Stevens     | USA     | 43.0       |
   | Dan       | Miller      | USA     | 40.0       |


## 3. Write a query to retrieve the top 5 best-selling artists by the number of tracks sold.

- ### Hint: You will need to join the `artists`, `albums`, `tracks`, and `invoice_items` tables and use aggregate functions to calculate the number of tracks sold by each artist.

## Expected Output

   | ArtistName           | TracksSold |
   |----------------------|------------|
   | Iron Maiden          | 140        |
   | U2                   | 107        |
   | Metallica            | 91         |
   | Led Zeppelin         | 87         |
   | Os Paralamas Do Sucesso| 45       |



## 4. Write a query to retrieve the total revenue generated by the store for each year.

- ### Hint: You will need to use the `invoices` table and extract the year from the `InvoiceDate` column using the YEAR function. Then, use the GROUP BY and SUM functions to calculate the total revenue generated for each year.

## Expected Output

   | Year | Revenue |
   -------|---------|
   | 2009 | 449.46  |
   | 2010 | 481.45 |
   | 2011 | 469.58|
   | 2012 | 477.53|
   | 2013 | 450.58| |
   -----------------


## 5. Write a query to retrieve the name of the employee who has generated the highest sales revenue in the year 2013.

- ### Hint: Revenue = SUM(invoice_item.Quantity * invoice_item.UnitPrice). <br>You will need to join the `employees`, `customers`, `invoices`, and `invoice_items` tables and use the WHERE and GROUP BY clauses to filter for sales made in the year 2013 and aggregate the total sales made by each employee.

## Expected Output


   | TopSalesPerson         | TotalRevenue |
   |------------------------|--------------|
   | Margaret Park          | 168.3        |



## 6. Write a query to retrieve the name of the artist who has the most albums in the database.

- ### Hint: You will need to join the `artists` and `albums` tables and use the GROUP BY and COUNT functions to count the number of albums for each artist and order the results in descending order.

## Expected Output

   | Artist With Most Albums |
   |-------------------------
   | Iron Maiden            |
   |                        |



## 7. Write a query to retrieve the number of tracks in each playlist.

- ### Hint: You will need to join the `playlists`, `playlist_track`, and `tracks` tables and use the GROUP BY and COUNT functions to count the number of tracks in each playlist.

## Expected Output

   | PlaylistName | NumTracks |
   |-------------|----------|
   | 90’s Music   | 1471     |
   | Audiobooks   | 0        |
   | Brazilian    | 39       |
   | Classical    | 75       |
   | Classical 101| 24       |
   | Heavy Metal  | 61       |
   | Music        | 658      |
   | Music Videos | 1        |
   | On-The-Go 1  | 1        |
   | TV Shows     | 426      |



## 8.Write a query to retrieve all invoices that contain at least one heavy metal track.

- ### Hint: You will need to join the `invoices`, `invoice_items`, `tracks`, and `genres` tables and use the WHERE clause to filter for heavy metal tracks.

## Expected Output

   | InvoiceId | InvoiceDate| Total    |
   -----------|------------|----------|
   | 11        | 2009-03-04 | 8.91     |
   | 12        | 2009-03-04 | 13.86    |
   | 13        | 2009-03-05 | 0.99     |
   | 25        | 2009-04-09 | 1.98     |
   | 27        | 2009-04-12 | 13.86    |
   | 30        | 2009-04-23 | 8.91     |
   | 31        | 2009-04-23 | 1.98     |
   | 34        | 2009-05-06 | 13.86    |
   | 36        | 2009-05-09 | 0.99     |
   | 49        | 2009-06-13 | 13.86    |
   | 57        | 2009-07-06 | 8.91     |
   | 60        | 2009-07-17 | 13.86    |
   | 62        | 2009-07-20 | 13.86    |
   | 69        | 2009-08-21 | 13.86    |
   | 78        | 2009-09-23 | 13.86    |
   | 83        | 2009-10-06 | 8.91     |
   | 86        | 2009-10-17 | 13.86    |
   | 88        | 2009-10-20 | 13.86    |
   | 95        | 2009-11-23 | 13.86    |
   | 102       | 2010-01-02 | 5.94     |


## 9.Write a query to retrieve the total number of tracks sold by each employee.

- ### Hint: You will need to join the `employees`, `customers`, `invoices`, `invoice_items`, and `tracks` tables and use the GROUP BY and SUM functions to calculate the total number of tracks sold by each employee.

## Expected Output


   | EmployeeName           | TotalTracksSold |
   |------------------------|----------------|
   | Jane Peacock            | 1749           |
   | Margaret Park           | 1600           |
   | Steve Johnson           | 1570           |



## 10.Write a query to retrieve the top 10 best-selling genres by the number of tracks sold.

   - ### Hint: You will need to join the `genres`, `tracks`, and `invoice_items` tables and use the GROUP BY and SUM functions to calculate the number of tracks sold for each genre, and then use the ORDER BY and LIMIT clauses to retrieve the top 10 best-selling genres.

## Expected Output

   | GenreName             | TotalTracksSold |
   |-----------------------|----------------|
   | Rock                  | 2635           |
   | Metal                 | 619            |
   | Alternative & Punk    | 492            |
   | Latin                 | 167            |
   | R&B/Soul              | 159            |
   | Blues                 | 124            |
   | Jazz                  | 121            |
   | Alternative           | 117            |
   | Easy Listening        | 74             |
   | Pop                   | 63             |
