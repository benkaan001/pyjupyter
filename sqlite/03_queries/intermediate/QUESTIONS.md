# INTERMEDIATE QUESTIONS

## Question 1

`Write a query to retrieve the top 10 customers who spent the most money at the store.`

Hint: You will need to join the `customers` and `invoices` tables and use an aggregate function to calculate the total amount spent by each customer.

### Expected Output

   | CustomerName        | TotalSpent|
   |---------------------|-----------|
   | Helena Holý         | 49.62     |
   | Richard Cunningham  | 47.62     |
   | Luis Rojas          | 46.62     |
   | François Tremblay   | 45.62     |
   | Edward Francis      | 42.62     |
   | Jack Smith          | 42.62     |
   | Michelle Brooks     | 39.62     |
   | Tim Goyer           | 39.62     |
   | Robert Brown        | 39.62     |
   | Jennifer Peterson   | 38.62     |


## Question 2
`Write a query to retrieve top 5 customers who live in the USA and have spent the most in year 2013.`

Hint: You will need to join the `customers` and `invoices` tables and use WHERE clauses to filter for customers who live in the USA.

### Expected Output

   | FirstName | LastName    | Country | TotalSpent |
   |-----------|-------------|---------|------------|
   | Richard   | Cunningham | USA     | 48.0       |
   | Julia     | Barnett     | USA     | 44.0       |
   | Frank     | Ralston     | USA     | 44.0       |
   | Victor    | Stevens     | USA     | 43.0       |
   | Dan       | Miller      | USA     | 40.0       |


## Question 3

`Write a query to retrieve the top 5 best-selling artists by the number of tracks sold.`

Hint: You will need to join the `artists`, `albums`, `tracks`, and `invoice_items` tables and use aggregate functions to calculate the number of tracks sold by each artist.

### Expected Output

   | ArtistName           | TracksSold |
   |----------------------|------------|
   | Iron Maiden          | 140        |
   | U2                   | 107        |
   | Metallica            | 91         |
   | Led Zeppelin         | 87         |
   | Os Paralamas Do Sucesso| 45       |



## Question 4

`Write a query to retrieve the total revenue generated by the store for each year.`

Hint: You will need to use the `invoices` table and extract the year from the `InvoiceDate` column using the YEAR function. Then, use the GROUP BY and SUM functions to calculate the total revenue generated for each year.

### Expected Output

   | Year | Revenue |
   -------|---------|
   | 2009 | 449.46  |
   | 2010 | 481.45 |
   | 2011 | 469.58|
   | 2012 | 477.53|
   | 2013 | 450.58| |
   -----------------


## Question 5

`Write a query to retrieve the name of the employee who has generated the highest sales revenue in the year 2013.`

Hint: Revenue = SUM(invoice_item.Quantity * invoice_item.UnitPrice). You will need to join the `employees`, `customers`, `invoices`, and `invoice_items` tables and use the WHERE and GROUP BY clauses to filter for sales made in the year 2013 and aggregate the total sales made by each employee.

### Expected Output


   | TopSalesPerson         | TotalRevenue |
   |------------------------|--------------|
   | Margaret Park          | 168.3        |



## Question 6

`Write a query to retrieve the name of the artist who has the most albums in the database.`

Hint: You will need to join the `artists` and `albums` tables and use the GROUP BY and COUNT functions to count the number of albums for each artist and order the results in descending order.

### Expected Output


   | ArtistWithMostAlbums | TotalAlbumCount |
   |----------------------|-----------------|
   | Iron Maiden          |      21         |



## Question 7

`Write a query to retrieve the number of tracks in each playlist.`

Hint: You will need to join the `playlist_track` table with the `playlists` table and use the GROUP BY clause to group the results by playlist. You can then use the COUNT() function to count the number of tracks in each playlist.You will need to use DISTINCT keyword to ensure that each playlist is listed only once.

### Expected Output

| Playlist Name              | Track Count |
|---------------------------|-------------|
| Music                     | 3290        |
| 90’s Music               | 1477        |
| TV Shows                  | 213         |
| Classical                | 75          |
| Brazilian Music           | 39          |
| Heavy Metal Classic       | 26          |
| Classical 101 - Deep Cuts | 25          |
| Classical 101 - Next Steps | 25          |
| Classical 101 - The Basics | 25          |
| Grunge                    | 15          |
| Music Videos              | 1           |
| On-The-Go 1               | 1           |



## Question 8

`Write a query to retrieve all invoices that contain at least one heavy metal track.`

Hint: You will need to join the `invoices`, `invoice_items`, `tracks`, and `genres` tables and use the WHERE clause to filter for heavy metal tracks. You will need to remove duplicates from invoices table.

### Expected Output

| InvoiceId | InvoiceDate             | Total |
|-----------|------------------------|-------|
| 145       | 2010-09-23 00:00:00    | 13.86 |
| 250       | 2012-01-01 00:00:00    | 13.86 |
| 39        | 2009-06-10 00:00:00    | 8.91  |
| 355       | 2013-04-10 00:00:00    | 13.86 |
| 40        | 2009-06-15 00:00:00    | 13.86 |


## Question 9a

`Write a query to retrieve the total number of tracks sold by each employee.`

Hint: You will need to join the `employees`, `customers`, `invoices`, `invoice_items`, and `tracks` tables and use the GROUP BY and SUM functions to calculate the total number of tracks sold by each employee.

### Expected Output


   | EmployeeId | EmployeeName  | TotalTracksSold |
   |-----------|---------------|----------------|
   | 3         | Jane Peacock  | 796            |
   | 4         | Margaret Park | 760            |
   | 5         | Steve Johnson | 684            |



 ## Question 9b

`Write a query to retrieve the total number of tracks in the database, the number of unsold tracks, and the current track inventory.`

Hint: You will need to join the `tracks` and `invoice_items` tables to find the unsold tracks, and a subquery to count the total number of tracks in the database.

### Expected Output

| OriginalTrackCount | UnsoldTrackCount | CurrentTrackInventory |
|--------------------|------------------|------------------------|
| 3503               | 1519             | 1984                   |




## Question 10

`Write a query to retrieve the top 10 best-selling genres by the number of tracks sold.`

Hint: You will need to join the `genres`, `tracks`, and `invoice_items` tables and use the GROUP BY and SUM functions to calculate the number of tracks sold for each genre, and then use the ORDER BY and LIMIT clauses to retrieve the top 10 best-selling genres.

### Expected Output

   | GenreName            | TotalTracksSold |
   |----------------------|-------------------|
   | Rock                   | 835                      |
   | Latin                   | 386                      |
   | Metal                 | 264                      |
   | Alternative & Punk | 244                      |
   | Jazz                    | 80                        |
   | Blues                   | 61                        |
   | TV Shows            | 47                        |
   | Classical            | 41                        |
   | R&B/Soul           | 41                        |
   | Reggae               | 30                        |

